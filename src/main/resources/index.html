<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14"></script>
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    <title>Seed shop</title>
    <style>
        * {
            font-family: Roboto, sans-serif;
            margin: 0;
            padding: 0;
        }

        .header {
            background-image: url('headerbg.jpg');
            background-size: contain;
            color: darkslategrey;
            font-size: 37px;
            font-family: "Bookman Old Style";
            text-align: center;
            height: 100px;
            line-height: 100px;
        }

        .footer {
            text-align: center;
        }

        .product-image {
            height: 150px;
            width: 150px;
            object-fit: cover;
        }


        .product-div {
            padding-bottom: 20px;
                display: flex;
                flex-direction: column;
                align-items: center;
                text-align: center;
        }
    </style>
</head>
<body>
    <div id="app">
        <el-row>
            <el-col :span="24">
                <div class="header">welcome to SeedScape</div>
            </el-col>
        </el-row>
        <el-row :gutter="20" style="margin-top: 10px">
            <el-col :span="12">
                <el-col :span="24">
                    <div>
                        <el-button @click="filterProducts('all')">All</el-button>
                        <el-button @click="filterProducts('vegetable')">Vegetable Seeds</el-button>
                        <el-button @click="filterProducts('flower')">Flower Seeds</el-button>
                        <el-button @click="filterProducts('fruit')">Fruit Seeds</el-button>
                    </div>
                </el-col>
                <el-col :span="8" v-for="(product, index) in filteredProducts" :key="index">
                    <div class="product-div">
                        <img :src="product.imageUrl" alt="Product Image" class="product-image">
                        <div>
                            <p style="font-size: large; color: brown; font-weight: bold">{{ product.name }}</p>
                            <p>{{ product.price }}</p>
                            <el-button size="mini" type="primary" @click="addToCart(product)">Add to Cart</el-button>
                            <el-button size="mini" type="success" style="margin-left: 0px; margin-top: 5px"
                                       @click="changeSeed(product)">Try on Mine</el-button>
                        </div>
                    </div>
                </el-col>
            </el-col>
            <el-col :span="12">
                <el-upload
                        class="upload-demo"
                        drag
                        action="#"
                        show-file-list="false"
                        :on-change="handlePicChange">
                    <i class="el-icon-upload"></i>
                    <div class="el-upload__text">Drag file to here or <em>click</em> to upload</div>
                </el-upload>
                <canvas id="canvas" width="500" height="500"></canvas>
            </el-col>
        </el-row>
        <el-row>
            <el-col :span="24">
                <div class="footer">&copy; 2023 Durhack</div>
            </el-col>
        </el-row>
    </div>

    <script>
        new Vue({
            el: '#app',
            data: {
                cartItems: [],
                products: [
                    {
                        name: 'Sunflower',
                        imageUrl: 'https://www.chilternseeds.co.uk/images/products/zoom/img_4408_988.jpg',
                        price: '£2.99',
                        category: 'flower',
                        seedUrl: 'transparentTree.png',
                    },
                    {
                        name: 'Rose',
                        imageUrl: 'https://m.media-amazon.com/images/I/61ghm5nrHQL._AC_.jpg',
                        price: '£2.99',
                        category: 'flower',
                        seedUrl: 'rsz_1rose.png'
                    },
                    {
                        name: 'Lily',
                        imageUrl: 'https://www.bhg.com/thmb/yLe88KZ9Akid_h_QqITRiH2wQpA=/750x0/filters:no_upscale():max_bytes(150000):strip_icc():format(webp)/100855507_preview-afb5bbe9dbf2432f81462b14e41a6c4c.jpg',
                        price: '£2.99',
                        category: 'flower'
                    },
                    {
                        name: 'Carrot',
                        imageUrl: 'https://greenvegetableseeds.com/wp-content/uploads/2016/01/Carrot-Romance-F1-www.greenvegetableseeds.com_.jpg',
                        price: '£3.99',
                        category: 'vegetable'
                    },
                    {
                        name: 'Lettuce',
                        imageUrl: 'https://m.media-amazon.com/images/I/81-H9Gy4+2L._AC_SL1280_.jpg',
                        price: '£3.99',
                        category: 'vegetable'
                    },
                    {
                        name: 'Cranberry',
                        imageUrl: 'https://www.suttons.co.uk/product_images/VECRA37600.jpg',
                        price: '£2.99',
                        category: 'fruit'
                    },
                    {
                        name: 'Strawberry',
                        imageUrl: 'https://www.suttons.co.uk/product_images/VESTR22389.jpg',
                        price: '£0.99',
                        category: 'fruit'
                    },
                ],
                selectedCategory: 'all',
                overlayImage: '',
                canvas: null,
                ctx: null
            },
            computed: {
                filteredProducts() {
                    if (this.selectedCategory === 'all') {
                        return this.products;
                    }
                    return this.products.filter(product => product.category === this.selectedCategory);
                }
            },
            methods: {
                handlePicChange(file) {
                    this.canvas = document.getElementById("canvas");
                    this.ctx = this.canvas.getContext("2d");
                    let gardenPic = new Image();
                    gardenPic.src = window.URL.createObjectURL(file.raw);
                    gardenPic.onload = () => {
                        this.ctx.drawImage(gardenPic, 0, 0, this.canvas.width, this.canvas.height);
                    }
                    this.canvas.addEventListener('mousedown', (e) => {
                        this.plant(e.offsetX, e.offsetY);
                    });
                },
                addToCart(product) {
                    // 添加购物车逻辑
                    // 这里可以实现将商品加入购物车的功能
                },
                filterProducts(category) {
                    this.selectedCategory = category;
                },
                plant(x, y) {
                    this.ctx.drawImage(this.overlayImage, x - this.overlayImage.width / 2, y - this.overlayImage.height, this.overlayImage.width, this.overlayImage.height);
                },
                changeSeed(seed){
                    console.log(seed);
                    this.overlayImage.src=seed.seedUrl;
                }
            },
            created() {
                this.canvas = document.getElementById("canvas");
                this.ctx = this.canvas.getContext("2d");
                this.overlayImage = new Image();
                this.overlayImage.src = 'transparentTree.png';
            }
        });
    </script>
</body>
</html>
